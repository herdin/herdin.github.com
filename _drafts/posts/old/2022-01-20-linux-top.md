---
layout: post
title: "linux top"
date: 2022-01-20
tags: linux
---

top: linux 자원상태를 모니터링하는 툴

> top 명령어 실행 시
``` shell
top - 23:11:28 up 638 days,  8:55,  1 user,  load average: 0.00, 0.03, 0.05
Tasks: 129 total,   1 running, 128 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.2 us,  0.2 sy,  0.0 ni, 99.5 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem :  8008628 total,   517908 free,  4221356 used,  3269364 buff/cache
KiB Swap:  4194300 total,  4187892 free,     6408 used.  3705884 avail Mem

   PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
     1 root      20   0   52140   3892   2432 S   0.0  0.0 551:50.18 systemd
     2 root      20   0       0      0      0 S   0.0  0.0   0:17.45 kthreadd
```
## cpu 
us : 프로세스의 유저 영역에서의 CPU 사용률
sy : 프로세스의 커널 영역에서의 CPU 사용률
ni : 프로세스의 우선순위(priority) 설정에 사용하는 CPU 사용률
id : 사용하고 있지 않는 비율
wa : IO가 완료될때까지 기다리고 있는 CPU 비율
hi : 하드웨어 인터럽트에 사용되는 CPU 사용률
si : 소프트웨어 인터럽트에 사용되는 CPU 사용률
st : CPU를 VM에서 사용하여 대기하는 CPU 비율

## memory
PID: 프로세스 ID이며 프로세스를 구분하기 위한 겹치지않는 고유한 값.
USER: 해당 프로세스를 실행한 USER 이름 또는 효과를 받는 USER의 이름.
PR : 커널에 의해서 스케줄링되는 우선순위.
NI : PR에 영향을 주는 nice라는 값.
VIRT, RES, SHR, %MEM : 메모리 관련
    VIRT : 프로세스가 소비하고 있는 총 가상(virtual) 메모리. 프로그램이 실행중인 코드, heap, stack과 같은 메모리, IO buffer 메모리를 포함. SWAP + RES
    RES : 프로세스가 사용중인 물리 메모리의 크기
    SHR : 다른 프로세스와의 공유메모리(Shared Memory)를 나타냄. 대부분의 리눅스 프로세스는 glibs 라이브러리를 참고하는데 이때 공유 라이브러리에 올려서 사용.
%CPU : 프로세스가 사용하는 CPU 사용율
%MEM : 프로세스가 사용하는 memory 사용율
S : 프로세스의 현재 상태 (작업중, I/O 대기, 유휴 상태 등)
    D : Uninterruptiable sleep. 디스크 혹은 네트워크 I/O를 대기
    R : 실행 중(CPU 자원을 소모)
    S : Sleeping 상태, 요청한 리소스를 즉시 사용 가능
    T : Traced or Stopped. 보통의 시스템에서 자주 볼 수 없는 상태
    Z : zombie. 부모 프로세스가 죽은 자식 프로세스
TIME+ : 프로세스가 사용한 토탈 CPU 시간
COMMAND : 해당 프로세스를 실행한 커맨드.


shift + m : order by memory
shift + p : order by cpu

참고
- [Linux top 명령어로 서버의 상태 파악하기](https://sabarada.tistory.com/146)

